---
## Front matter
title: "Загрузка WINDOWS"
subtitle: "Доклад"
author: "Зубов Иван Александрович"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---


# Введение

Сегодня мы рассмотрим один из фундаментальных процессов, с которым сталкивается каждый пользователь компьютера - загрузка операционной системы Windows.Этот многоэтапный и строго последовательный механизм, который часто называют "boot process", превращает наш выключенный компьютер в готовый к работе инструмент. Понимание этого процесса не только интересно с технической точки зрения, но и полезно на практике, например, для диагностики неисправностей.

# Аппаратная фаза

Аппаратная фаза — это начальный этап загрузки, управляемый микропрограммами BIOS/UEFI, который включает самотестирование оборудования и поиск загрузчика на подключенных накопителях.

## Начало работы 

Процесс загрузки можно условно разделить на две крупные фазы: аппаратная, управляемая микропрограммами материнской платы, и программная, управляемая уже самой операционной системой.
Всё начинается с нажатия кнопки питания. После этого управление берет на себя микропрограмма BIOS (Basic Input/Output System) или ее более современный преемник – UEFI (Unified Extensible Firmware Interface). Несмотря на различия, их основная задача на этом этапе схожа.
Первым делом выполняется самотестирование при включении, или POST. Это диагностическая процедура, которая проверяет исправность критически важных компонентов: процессора, оперативной памяти, видеокарты и накопителей. Если проверка проходит успешно, система подает короткий звуковой сигнал, и мы можем увидеть на экране логотип производителя материнской платы.


## Поиск загрузчика операционной системы

Затем BIOS/UEFI приступает к поиску загрузчика операционной системы. Он просматривает подключенные накопители в порядке, заданном в настройках. Найдя подходящий диск, система ищет на его первом секторе главную загрузочную запись – MBR. В этом месте находится небольшой фрагмент кода, который и является первым программным загрузчиком, а также таблица разделов диска.

## Cовременный подход: UEFI и ESP

Здесь на сцену выходит более современный и безопасный подход UEFI. Вместо поиска MBR, он использует специальный раздел на диске, называемый ESP (EFI System Partition). Этот раздел содержит файлы загрузчиков в собственном формате, что делает процесс более надежным и быстрым.

# Программная фаза

Программная фаза начинается с передачи управления загрузчику Windows, который загружает ядро системы и основные драйверы, подготавливая запуск основных системных процессов.

## Роль диспетчера загрузки Windows

Независимо от того, был ли использован MBR или UEFI, следующим шагом управление переходит к менеджеру загрузки Windows – файлу Boot Manager. Его главная задача – считать данные конфигурации загрузки из хранилища BCD (Boot Configuration Data). Это хранилище заменяет собой устаревший файл boot.ini и содержит информацию обо всех установленных операционных системах на компьютере. Если у нас установлено несколько ОС, именно на этом этапе мы видим меню выбора.

## Загрузка основного загрузчика и ядра системы

Выбрав нужную систему, Boot Manager загружает в память основной загрузчик – файл winload.exe (Windows OS Loader), который уже находится на системном разделе. На этом этапе ответственность за процесс окончательно переходит от firmware к самой операционной системе.

## Критически важные действия загрузчика

Загрузчик winload.exe выполняет ряд критически важных действий. Он загружает в память ядро операционной системы – ntoskrnl.exe, а также основные драйверы устройств, без которых работа системы невозможна. Кроме того, он подгружает динамическую библиотеку Hardware Abstraction Layer, которая служит прослойкой между ядром и аппаратным обеспечением, делая систему менее зависимой от конкретного "железа".

# Финальный этап: инициализация системы и вход пользователя

Финальный этап — это полная инициализация ядра, запуск служб и процессов входа, которые в конечном итоге загружают пользовательский интерфейс и приложения автозагрузки, делая систему полностью готовой к работе.

## Запуск ядра и диспетчера устройств

После загрузки ядра управление передается ему. Ядро инициализирует все системные компоненты, запускает диспетчер Plug and Play для обнаружения и настройки всего оборудования, а затем стартует сеанс подсистемы Windows.

## Роль диспетчера сеансов (smss.exe)

Запускается процесс smss.exe (Session Manager). Это первый процесс, созданный системой, и он играет ключевую роль. Он создает переменные среды, подкачиваемую память и, что самое важное, запускает подпроцессы csrss.exe (подсистема клиент-сервер) и winlogon.exe.

## Процесс входа в систему

Именно winlogon.exe отвечает за процедуру входа пользователя в систему. Он выводит на экран знакомый нам интерфейс входа – приветственный экран. Когда пользователь вводит свои учетные данные, winlogon передает их для проверки процессу lsass.exe (Local Security Authority Subsystem Service), который и отвечает за аутентификацию.

## Завершение загрузки: появление рабочего стола

После успешной проверки подлинности winlogon загружает профиль пользователя и запускает оболочку операционной системы – проводник explorer.exe. Одновременно с этим фоновой планировщик задач services.exe запускает все автоматические системные службы и приложения из автозагрузки. И вот, перед нами появляется рабочий стол – операционная система полностью загружена и готова к работе.

# Заключение

Таким образом, загрузка Windows - Это не мгновенное чудо,а сложный и многоуровневый механизм. Он предствляет собой четкую эстафету , где управление последовательно передается от микропрограмм материнской плате к простым загрузчикам , а от них уже к мощному ядру операционной системы и,наконец к пользовательской оболочке. Каждый этап критически важен, и сбой на любом из них может привести к невозможности запуска системы. Понимание этих этапов позволяет не только глубже познать архитектуру ОС, но и грамотно подходить к решению возможных проблем с загрузкой.

# Список литературы 

1. https://translated.turbopages.org/proxy_u/en-ru.ru.e083c1da-690227d5-1738c4bd-74722d776562/https/www.freecodecamp.org/news/linux-boot-process-in-rhel/#heading-post-power-on-self-test
2. Сайт Хабр - https://habr.com/ru/companies/pt/articles/164121
3. Майкрософт-https://learn.microsoft.com/ru-ru/windows-hardware/drivers/devtest/boot-options-in-windows
4. РуВики - https://ru.ruwiki.ru/wiki/Процесс_запуска_Windows_NT


